; NekoMake build script for nekosys
;

; Constants
CCFLAGS = -std=gnu99 -ffreestanding -mno-red-zone -fno-exceptions -nostdlib -Wall -Wextra -Werror -fno-pie -O2

; Tools
[asm, multi]:
    nasm -f {format=bin} {input} -o {output}
    
[cc, single]:
    neko-gcc {input} -o {output} -T kernel.ld {CCFLAGS} {include}

; Targets   
clean:
    rm -rf build/
    mkdir build/
    mkdir build/intermediate	

bootloader:		
    [asm]
        input: boot/*.asm
        output: build/~.bin
    
kernel:
    [asm]
        input: kernel/**.asm
        format: elf32
        output: build/intermediate/~.o
        
    [cc]
        input: build/intermediate/*.o
               kernel/**.c
			   libc/**.c
               
        include: -I kernel/include
                 -I libc/include
                 
        output: build/NEKOKRNL